import React, { useState, useEffect, useCallback } from 'react';
import { Heart, Flower2, Sparkles, Star, music, Ghost } from 'lucide-react';

const App = () => {
  const [accepted, setAccepted] = useState(false);
  const [noButtonPos, setNoButtonPos] = useState({ top: '0px', left: '0px' });
  const [isHoveringNo, setIsHoveringNo] = useState(false);
  const [noCount, setNoCount] = useState(0);
  const [yesButtonSize, setYesButtonSize] = useState(1);

  const successImage = "https://images.unsplash.com/photo-1518199266791-5375a83190b7?q=80&w=1000&auto=format&fit=crop";

  const noMessages = [
    "No",
    "Are you sure?",
    "Really sure??",
    "Pookie please!",
    "Don't do this to me :(",
    "I'm gonna cry...",
    "You're breaking my heart!",
    "Think again!",
    "Is that your final answer?",
    "Okay, now you're just being mean!",
    "STOP IT!",
    "Just click Yes already!",
  ];

  const moveButton = useCallback(() => {
    // Avoid the button jumping outside the visible area
    const padding = 100;
    const x = Math.random() * (window.innerWidth - padding * 2) + padding;
    const y = Math.random() * (window.innerHeight - padding * 2) + padding;
    
    setNoButtonPos({ top: `${y}px`, left: `${x}px` });
    setIsHoveringNo(true);
    setNoCount((prev) => (prev + 1) % noMessages.length);
    setYesButtonSize((prev) => prev + 0.15); // Yes button grows as they struggle
  }, [noMessages.length]);

  const handleYes = () => {
    setAccepted(true);
  };

  return (
    <div className="min-h-screen bg-[#fff0f3] flex flex-col items-center justify-center p-4 font-sans overflow-hidden relative">
      {/* Dynamic Background Elements */}
      <div className="absolute inset-0 pointer-events-none z-0">
        <div className="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-pink-200 rounded-full blur-[120px] opacity-50 animate-pulse"></div>
        <div className="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-red-100 rounded-full blur-[120px] opacity-50 animate-pulse delay-700"></div>
      </div>

      {!accepted ? (
        <div className="relative z-10 animate-fade-in-up">
          <div className="bg-white/80 backdrop-blur-lg p-8 md:p-12 rounded-[3.5rem] shadow-[0_20px_50px_rgba(255,182,193,0.4)] border border-white text-center max-w-md w-full transition-all duration-500 hover:shadow-[0_25px_60px_rgba(255,105,180,0.3)]">
            
            <div className="mb-8 flex justify-center items-center gap-2">
              <Heart className="text-red-500 fill-red-500 animate-heart-beat" size={48} />
              <Heart className="text-pink-400 fill-pink-400 animate-heart-beat delay-150" size={32} />
            </div>
            
            <h1 className="text-4xl md:text-5xl font-extrabold text-slate-800 mb-4 tracking-tight leading-tight">
              Will you be my <span className="text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-pink-500">Valentine?</span>
            </h1>
            
            <p className="text-slate-500 mb-10 font-medium text-lg">I've been waiting to ask you this for a while...</p>

            <div className="flex flex-col sm:flex-row items-center justify-center gap-4 min-h-[80px]">
              <button
                onClick={handleYes}
                style={{ transform: `scale(${yesButtonSize})` }}
                className="bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white px-12 py-4 rounded-2xl text-2xl font-bold shadow-[0_10px_20px_rgba(239,68,68,0.3)] transition-all active:scale-95 flex items-center gap-3 z-20 group"
              >
                YES! <Heart size={24} className="fill-white group-hover:scale-125 transition-transform" />
              </button>

              <button
                onMouseEnter={moveButton}
                onClick={moveButton}
                style={isHoveringNo ? { position: 'fixed', top: noButtonPos.top, left: noButtonPos.left, transition: 'all 0.2s ease-out' } : {}}
                className="bg-slate-100 text-slate-400 px-8 py-4 rounded-2xl text-xl font-bold border border-slate-200 hover:bg-white hover:text-slate-600 hover:shadow-lg transition-all duration-150 whitespace-nowrap z-10"
              >
                {noMessages[noCount]}
              </button>
            </div>
          </div>
          
          <div className="mt-8 text-center text-slate-400 font-medium animate-pulse no-print">
            Hover or tap to decide! âœ¨
          </div>
        </div>
      ) : (
        <div className="relative z-10 w-full max-w-2xl px-4 animate-scale-in">
          <div className="bg-white p-6 md:p-10 rounded-[3.5rem] shadow-2xl border-4 border-white text-center overflow-hidden">
            <div className="mb-6 flex justify-center items-center gap-3">
              <Sparkles className="text-yellow-400 animate-spin-slow" size={32} />
              <h2 className="text-4xl md:text-5xl font-black text-slate-800">
                Yay! <span className="text-red-500 italic">Happy Valentine's!</span>
              </h2>
              <Sparkles className="text-yellow-400 animate-spin-slow" size={32} />
            </div>
            
            <div className="relative group rounded-3xl overflow-hidden border-8 border-pink-50 shadow-2xl transition-transform duration-700 hover:scale-[1.02]">
              <img 
                src={successImage} 
                alt="Guy with Flowers" 
                className="w-full h-auto object-cover"
              />
              <div className="absolute inset-0 bg-gradient-to-t from-pink-500/40 via-transparent to-transparent opacity-60"></div>
              
              <div className="absolute bottom-6 left-0 right-0 text-white animate-bounce-slow">
                 <Heart className="mx-auto fill-white" size={40} />
              </div>
            </div>
            
            <div className="mt-10 space-y-4">
              <p className="text-2xl text-pink-600 font-serif italic font-bold">
                "I promise to make every day feel like Valentine's with you."
              </p>
              <div className="flex justify-center gap-6 pt-4">
                <Flower2 className="text-red-400 animate-bounce" style={{ animationDelay: '0ms' }} size={36} />
                <Flower2 className="text-red-500 animate-bounce" style={{ animationDelay: '200ms' }} size={36} />
                <Flower2 className="text-red-400 animate-bounce" style={{ animationDelay: '400ms' }} size={36} />
              </div>
            </div>
          </div>
        </div>
      )}
      
      {/* Floating Hearts Background Particle System */}
      <div className="fixed inset-0 pointer-events-none opacity-40 z-0 overflow-hidden">
        {[...Array(25)].map((_, i) => (
          <div 
            key={i}
            className="absolute animate-float"
            style={{
              top: `${Math.random() * 100}%`,
              left: `${Math.random() * 100}%`,
              animationDuration: `${Math.random() * 5 + 5}s`,
              animationDelay: `${Math.random() * 5}s`
            }}
          >
            <Heart 
              size={Math.random() * 30 + 10} 
              className={`${Math.random() > 0.5 ? 'text-pink-300' : 'text-red-200'} fill-current`} 
            />
          </div>
        ))}
      </div>
      
      <style>{`
        @keyframes heart-beat {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.2); }
        }
        @keyframes float {
          0% { transform: translateY(0) rotate(0deg); opacity: 0; }
          20% { opacity: 0.8; }
          100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(40px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @keyframes scale-in {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        @keyframes spin-slow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes bounce-slow {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }
        .animate-heart-beat {
          animation: heart-beat 1.5s ease-in-out infinite;
        }
        .animate-float {
          animation: float linear infinite;
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.8s ease-out forwards;
        }
        .animate-scale-in {
          animation: scale-in 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        .animate-spin-slow {
          animation: spin-slow 12s linear infinite;
        }
        .animate-bounce-slow {
          animation: bounce-slow 2s ease-in-out infinite;
        }
      `}</style>
    </div>
  );
};

export default App;
